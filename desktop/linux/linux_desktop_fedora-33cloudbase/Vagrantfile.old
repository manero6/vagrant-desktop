# -*- mode: ruby -*-
# vi: set ft=ruby :

VM_BOX = ENV["VM_BOX"] || "fedora/33-cloud-base"
VM_RAM = ENV["VM_RAM"] || "1024"
VM_CPU = ENV["VM_CPU"] || "2"

Vagrant.configure("2") do |config|

  config.vm.box = VM_BOX

  config.vm.provider "libvirt" do |lv|
      lv.memory = VM_RAM
      lv.cpus = VM_CPU
      lv.graphics_type = "spice"
      lv.video_type = "qxl"
      lv.channel type: "spicevmc", target_name: "com.redhat.spice.0", target_type: "virtio"
      lv.channel type: "unix", target_name: "org.qemu.guest_agent.0", target_type: "virtio"
  end
  config.vm.provider "virtualbox" do |vb|
      vb.memory = VM_RAM
      vb.cpus = VM_CPU
  end

  vm_name = "gnome"
  config.vm.define "fedora-#{vm_name}" do |vm|
    vm.vm.hostname = "fedora-#{vm_name}"
    vm.vm.provision vm_name, type: "shell", path: "../../../provision/shell/dnf/#{vm_name}.sh"
    vm.vm.provision "graphical", type: "shell", path: "../../../provision/shell/systemctl/set-graphical-target.sh"
    vm.vm.provision "reboot", type: "shell", inline: "reboot"
  end

  vm_name = "kde"
  config.vm.define "fedora-#{vm_name}" do |vm|
    vm.vm.hostname = "fedora-#{vm_name}"
    vm.vm.provision vm_name, type: "shell", path: "../../../provision/shell/dnf/#{vm_name}.sh"
    vm.vm.provision "graphical", type: "shell", path: "../../../provision/shell/systemctl/set-graphical-target.sh"
    vm.vm.provision "reboot", type: "shell", inline: "reboot"
  end

  vm_name = "xfce"
  config.vm.define "fedora-#{vm_name}" do |vm|
    vm.vm.hostname = "fedora-#{vm_name}"
    vm.vm.provision vm_name, type: "shell", path: "../../../provision/shell/dnf/#{vm_name}.sh"
    vm.vm.provision "graphical", type: "shell", path: "../../../provision/shell/systemctl/set-graphical-target.sh"
    vm.vm.provision "reboot", type: "shell", inline: "reboot"
  end

  vm_name = "lxqt"
  config.vm.define "fedora-#{vm_name}" do |vm|
    vm.vm.hostname = "fedora-#{vm_name}"
    vm.vm.provision vm_name, type: "shell", path: "../../../provision/shell/dnf/#{vm_name}.sh"
    vm.vm.provision "graphical", type: "shell", path: "../../../provision/shell/systemctl/set-graphical-target.sh"
    vm.vm.provision "reboot", type: "shell", inline: "reboot"
  end

  vm_name = "lxde"
  config.vm.define "fedora-#{vm_name}" do |vm|
    vm.vm.hostname = "fedora-#{vm_name}"
    vm.vm.provision vm_name, type: "shell", path: "../../../provision/shell/dnf/#{vm_name}.sh"
    vm.vm.provision "graphical", type: "shell", path: "../../../provision/shell/systemctl/set-graphical-target.sh"
    vm.vm.provision "reboot", type: "shell", inline: "reboot"
  end

  vm_name = "mate"
  config.vm.define "fedora-#{vm_name}" do |vm|
    vm.vm.hostname = "fedora-#{vm_name}"
    vm.vm.provision vm_name, type: "shell", path: "../../../provision/shell/dnf/#{vm_name}.sh"
    vm.vm.provision "graphical", type: "shell", path: "../../../provision/shell/systemctl/set-graphical-target.sh"
    vm.vm.provision "reboot", type: "shell", inline: "reboot"
  end

  vm_name = "cinnamon"
  config.vm.define "fedora-#{vm_name}" do |vm|
    vm.vm.hostname = "fedora-#{vm_name}"
    vm.vm.provision vm_name, type: "shell", path: "../../../provision/shell/dnf/#{vm_name}.sh"
    vm.vm.provision "graphical", type: "shell", path: "../../../provision/shell/systemctl/set-graphical-target.sh"
    vm.vm.provision "reboot", type: "shell", inline: "reboot"
  end

end
